%\documentclass[10pt,a4paper]{article}
\documentclass[twoside,openright]{scrreprt}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{graphicx}
\usepackage{svg}

\usepackage{stackrel}
\usepackage{caption}
\usepackage{subcaption}

\usepackage{longtable}
\usepackage{booktabs}
\usepackage{siunitx}
\usepackage{gensymb}

\usepackage[msc]{tugrazthesis}


\begin{document}
%--- INFORMATION FOR TITLEPAGE -------------------------------------------------

% Your name including previous academic degrees (optional argument sets a different \author{}):
\thesisauthor[Firstname Lastname]{Firstname Lastname, BSc}

% Title of your thesis (optional argument sets a different \title{}):
\thesistitle[Short Thesis Title]{Title and\\Subtitle\\of the Thesis\\(up to 4 Lines)}

% Date of completion (optional argument sets a different \date{})
\thesisdate[ ]{Month Year}

% Supervisor headline (select male/female/plural version)
\supervisortitle{\germanenglish{Betreuerin/Betreuer}{Supervisor}}

% Supervisor info
\supervisor{%
  Markus Koch, academic degrees of supervisor\\
  up to 2 lines

  Institute of Experimental Physics\\
  up to 2 lines

  %optional extra information (second advisor, name of faculty, etc.)\\
  %up to 2 lines
}

% Academic degree achieved with this thesis, according to your curriculum (check curriculum and select male/female version):
\academicdegree{Diplom-Ingenieur}

\chapter{Prerequisites}
\section{Transient pump probe spectroscopy}
Using two short, in the femtosecond region, laser pulses a samples fast response to excitation is measured. This is observed as a change in optical density. Time resolution of this transient process comes from delaying one of shifting the point in time where one of the pulses passes the sample relative to the other, which is usually done by a simple path length change of one of the pulses.\newline
First a probe pulse of photon flux within a wavelength range passes through the sample and the remaining intensity is detected as $\mathrm{I_{probe}(\lambda_{probe})}$. \\
Secondly, after a period of time to allow the sample to relax back to its initial state, a pump pulse $\mathrm{I_{pump}(\lambda_{pump})}$ excites a volume of the sample. This leads to a direct change of the optical density of the excited sample volume, which alters the transmission of the probe photons $\mathrm{I_{pump-probe}(\lambda_{probe}, \lambda_{pump}, \Delta t)}$ depending on the time delay $\Delta t$ between the pulses passing the sample volume and the pump and probe wavelengths $\lambda_{pump}/\lambda_{probe}$ respectively. \\
The change in absorptive properties of the sample depending on the pump pulse is characterised in the transient absorbance $\mathrm{\Delta A}$, which often is given in orders of magnitude of the optical density. It is defined as seen in eq. \ref{eq:TA}.
\begin{equation}\label{eq:TA}
\begin{split}
\Delta A(\lambda_{\mathrm{pump}}, \lambda_{\mathrm{probe}}, \Delta t)&=-\log _{10}\left(\frac{I_{\mathrm{pump}-\mathrm{probe}}\left(\lambda_{\mathrm{pump}}, \lambda_{\mathrm{probe}}, \Delta t\right)}{I_{\mathrm{probe}}\left(\lambda_{\mathrm{probe}}\right)}\right)\\
&=-\log _{10}\left(1+\frac{\Delta I_{\mathrm{probe}}\left(\lambda_{\mathrm{pump}}, \lambda_{\mathrm{probe}}, \Delta t\right)}{I_{\mathrm{probe}}\left(\lambda_{\mathrm{probe}}\right)}\right)
\end{split}
\end{equation}

\section{Transient effects in pump probe spectroscopy}
There are several types of contrast within pump probe spectroscopy. Processes like two-photon-fluorescence, second or third harmonic generation (and SRS?) are too high power for our samples and would lead to immediate deactivation. They are thus not going to be addressed further with respect to the sample transient processes. The most relevant ones for this experimental setup are:\cite{10.1063/1.5129123}
\begin{itemize}
\item Stimulated Emission (SE): Possible in cases where a state below or at the  excited level has a transition to a lower state corresponding to the other photon wavelength used. This could be either pump or probe exciting and then the other leading to stimulated emission. However as the change in the probe is measured only contrast for pump excitation with probe stimulated emission is possible. The emitted photons are of identical energy to the probe pulse and thus an increase in transmission is observed.
\item Ground State Depletion (GSD): By moving part of the ground state population to different energy levels the probe pulse sees a smaller absorption cross-section. This is seen as a positive change in transmission. The signal returns by an exponential, sometimes multi-exponential when multiple states are excited, decay to the starting transmission value as the molecules relax back to the ground state.
\item Excited State Absorption (ESA): Similar to GSB a population transfer from the ground state happens, however with this population transfer now a state previously not accessible with the probe pulse becomes accessible, thus leading to an increase in absorption and a reduction of transmission.
\item Photothermal Effect: Due to heating from strong absorption of the pump beam a change in the refractive index changes the propagation path of the probe beam. It can be avoided by having a larger numerical aperture in the rear focusing element, the condensor, than for the front focusing element and changing modulation frequency.
\item Cross Phase Modulation (XPM): Through the optical Kerr effect the refractive index changes when both pump and probe beam are temporally overlapped within the sample. This may be used to check the instrumental response of the transient absorption microscope. It can be avoided like the photothermal effect by a larger condensor numerical aperture.
\item Stimulated Raman Scattering: In case the energy difference between pump and probe corresponds to a raman active state a photon transfer from the higher energy beam to the lower energy beam may happen. For this there needs to be temporal overlap of the beams
\end{itemize}

These processes may manifest at the same time, thus concealing other processes with the opposite influence on the transient opacity. This is not so much of concern for processes like XPM or stimulated raman scattering, because they require temporal overlap of pump and probe pulse and thus only influence a short range within the time delay based on the pulse lengths. \\
\textbf{
Tell them about what happens if probe intensity is too high. -> self GSD of probe that leads to bad measurement values; maybe do in reliability}
\subsection{Polarization angles}
Pump probe measurements of same polarization obviously return the highest signal in any case. However when working with liquids or (solid) solutions like PMMA in this case the molecules, if relatively unperturbed by the environment, may rotate over time and thus change the direction of their transition dipole moments relative to where they would be in their zero time direction. This leads to a measurable signal change over time.\\
The rotation in the sample is given by the anisotropy at detection:\textbf{find better source}
\begin{equation*}
r = \frac{I_{\parallel}-I_{\perp}}{I_{\parallel}+2I_{\perp}}
\end{equation*}
where $\mathrm{I_\parallel}$ is the component, where pump and probe are parallel polarizations, and $\mathrm{I_\perp}$ is the component perpendicular to the pump polarization. The reason for the factor 2 in the enumerator is that the original polarization can rotate into two perpendicular directions, which are projected into a direction perpendicular to the pump polarization.???\\
By measuring at the so called "magic angle" of $\theta = 54.7 \degree$ the parallel and orthogonal polarization components are polarized and the measurement is made isotropic. This is based on the transmission of polarized light through a polarizer $I(\theta) = I_0 cos^2(\theta)$.\\
Alternatively this isotropic output may also be achieved by measuring parallel and orthogonal polarisations and using an arithmetic correction. The total intensity is $I_T = I_x+I_y+I_z = 2\cdot I_\perp + I_\parallel$. To now correct for both rotation directions out of parallel plane the signal may be corrected to $I = \frac{I_\parallel + 2I_\perp}{3}$, which corresponds to the isotropic signal.\cite{Zheng2020}

%Depending on the rate at which the sample decays we should be able to ignore that?
%Our sample is isotropic, so that means we would see, if it was the case that transition dipole of the excited state for the probe was perpendicular to our pump polarization and we still probe parallel to pump, the signal would be rising and still be able to detect if there was a state at that point. Check maybe I have a perpendicular measurement where I can check the rise time, it was relatively quick I remember. Main problem with magic angle is loss of the transient absorption edge, which we like to compare to since we usually use very anisotropic samples.

\subsection{Squaraines}
\subsubsection{SQIB in PMMA}
\textbf{Manuela transmission plot of 1\% sample}
\chapter{Devices and Setup}

Part of the experimental objective was to extend the range of the transient absorption microscope (TAM) into the UV range via SHG of the probe NOPA output. With the extension a wavelength range of 250 nm to 940 nm, with a gap between 470 nm and 500 nm, is available for probing the sample.\newline
To achieve this range a few optics, most notably the achromatic objectives used to image the sample, had to be exchanged for optics non absorbing in the UV.
\section{Regular Transient Absorption Microscope Setup}\label{RegTAM}
A short description of the experimental setup for the Transient Absorption Microscope (TAM), as it was before attempting an extension to higher photon energies follows. For further details see previous work (cite robert master thesis)\\
As a laser source a PHAROS femtosecond laser by Light Conversion is used with an output of 400 µJ at 20 kHz with a pulse length in the range of 270 fs. The output is evenly split between two Orpheus Non-Collinear Optical Parametric Amplifiers (NOPAs), where one is setup with second harmonic (2H) for the pump pulses (650 nm - 940 nm) and the other is setup with third harmonic (3H) for the probe pulses (500 nm - 940 nm). Long term output power stability is mainly important for the pump pulse, which is why the setup, including the compressor the PHAROS, is optimized for maximum stability of the 2H NOPA. Meanwhile having little shot to shot fluctuations is important in all cases. PHAROS is the most reliable part of the setup, with exception of the compression setting which may need adjusting every once upon a while.\\

The light following the pump path goes through several apertures and ND filters, which may be absorptive glass filters or metal coated reflective filters which may also be gradient filters for linear adjustability, until the beam reaches the linear delay stage, which uses a Newpot LTA-HS actuator. The beam path is then led through the chopper by the use of a roughly 1:1 telescope around it, which blocks every second pulse leaving a half frequency signal for the pump. The chopper is synchronised to a signal output of PHAROS, which allows for setting a delay such that there is just a binary on and off modulation of the pump, compared to a partial chopping of beams at full frequency. After passing through a lambda half wave plate the beam enters the common path in the cage with the sample.

The probe beam has the same treatment of apertures and ND filters, including a variable reflective one, and goes through a $\mathrm{\lambda/2}$ plate until it reaches the common path.


For detection of the transient signal a custom made detector based on Hamamatsu S1336-8BQ Si photodiode is used in combination with an analogue long pass amplification circuit stretching the signal such that it can be measured with a picoscope 5442D. For all measurements detector "A" was used. The diode is fit for measurements in the wavelength range of 190-1100 nm. The actual quantum efficiency change over the spectral range does not matter in detail, as the variation over the spectral range is slow and for the spectral range of a probe setting does not exceed 10\% change at any point.

\section{UV extended Transient Absorption Microscope Setup}
This section will address the issues addressed with the extended setup as well as attempted solutions and the final changes to make it work.

\begin{figure}[h]
\centering
\includegraphics[width=0.9\linewidth]{images/ComponentLibrary_svg/experimental_tam_shg_swapped.png}
\caption{UV extended TAM\\Pump adjustable for 650 nm to 940 nm
\\Probe adjustable between 500 nm and 940 nm with the option of separate range of 250 nm and 470 nm via SHG crystal\\
SHG stage shown including optional filters to remove white light from NOPA (ahead of SHG crystal) and fundamental wavelength of SHG (after SHG crystal)\\ Cage setup in further detail in fig. \ref{Fig:CageSetup}}
\end{figure}

\begin{figure}[h]\label{Fig:CageSetup}
\centering
\includegraphics[width=0.9\linewidth]{images/ComponentLibrary_svg/SHG-focusing-large.png}
\caption{Detail view of new components in TAM\\ Ahead of first show probe lens white light remainder from NOPA may be filtered and after the second lens the fundamental may be filtered\\
Rear camera shown as coupled out of the standard path, however it is advised to instead have the rear camera in the standard detector path and only insert the mirror coupling into the mirror when doing measurements.}
\end{figure}

\subsection{Cage setup}
To accommodate the lower wavelengths the objectives have to be exchanged for wavelengths below 350 nm, where absorption reduces the transmission of the objective combination severely. Furthermore only one of the objectives is rated down to 350 nm raising the question of if their achromacity still is a viable assumption.\newline
The objectives are replaced with  uncoated 125 nm plano-convex UV fused silica (UVFS) lenses from EKSMA\footnote{?110-1216E?}, with the convex side placed such that the collimated beam enters or exits the convex side. This means that the planar sides of the lenses point towards the sample as can be seen in fig. \protect\ref{Fig:CageSetup}. This is done to reduce spherical aberration.
\newline
The plano-convex lenses are neither apochromatic nor achromatic and thus exhibit chromatic aberration, leading to an issue that will be addressed in \ref{SHG-Stage-desc}. \newline

\subsection{Second Harmonic Generation stage}\label{SHG-Stage-desc}
The Second Harmonic Generation (SHG) stage addresses multiple issues. 
\begin{itemize}
\item The 3H NOPA used for the probe beam does not supply high enough power to allow for stable SHG over the entire output wavelength range of the NOPA without a focusing element increasing the power locally within the crystal. 
\item The chromatic aberration or focus shift within the cage system means that a degree of freedom on the focus of the probe needs to be included as to allow for adjustments to the pointspread function of the probe.
\end{itemize}


The solution to these issues is an adjustable telescope of biconvex lenses, of which the second lens has to be UV transmissive. To achieve a stable second harmonic generation (SHG) a telescope was built with two spherical lenses. The front lens is a 85 mm lens in a mount adjustable for horizontal and vertical displacement orthogonal to the beam path and the rear lens is a 75 mm UVFS lens on a linear stage, to provide a degree of freedom for the focus of the probe beam, which is necessary to account for the achromacity of the extended setup.
\subsubsection{Operation}
\paragraph{Setting up}
The task of setting up the SHG stage is non trivial regarding proper alignment and linear stage positioning, such that the ~5 cm of movement are sufficient to adjust for the chromatic aberration within the targeted wavelength range for probe. This task often ends up being trial and error in correspondence to checking multiple wavelengths. The cage lenses have to be in their correct positions first.\newline
Irises etc are beneficial if there is a working setup.\newline
Use irises to shape the probe beam to an acceptable Gaussian shape while avoiding diffraction effects. Optimally the incoming beam is level with the table, since any inclination will introduce an astigmatism? depending on the rear lens position.\newline
Begin with the first lens in the path leaving enough space for the linear stage and the SHG crystal to the next static optic. Set lens centered regarding beam. Use the irises in front of the lens to adjust the reflection on the lens surface to return the exact incoming beampath.\newline
Place the rear stage lens and once again adjust for center position. One may again use the reflection and additionally the transmitted beam to tell if the stage is parallel to the beam path. The center of the beam should not move when translating the stage and the expansion of the beam diameter should be as symmetric as possible. Adjusting via the reflection is not such a clear indication of alignment here, as there are multiple convex surfaces in play at this point, leading to multiple focal beams, what may not be in full accordance with each other. For this usually it was chosen to get the highest intensity spot, which refers to the final glass/air surface of the second lens, in the incoming beam path. This spot is also focused, which makes adjustment easier.\newline
Finally one can adjust mirrors after the stage to get an image on the camera again, as even relatively minute changes in alignment will lead to some beam offset and change in direction. Translating the stage then will give an indication of how well the SHG stage is set up in regards to astigmatism which can be seen as non symmetric expansion of the beam. However beware that the mirror outcoupling in the cage also influences the way a change in focus is experienced, due to deviations from an orthogonal inclination angle to the sensor.
\paragraph{For measurements}
To find SHG intensity approach from the incoming beam direction and adjust SHG crystal until sufficient output power is achieved.\newline
Adjust the linear stage such that there is no lateral movement. The current stage slide is mounted in a way that can rotate a bit if force is applied at the corners. It may be necessary to do this and have the stage "snap back" to make sure it will not move during the measurement. This can be checked after the measurement by checking the overlap again.
\subsection{Detector Setup}
The detectors themselves are the same as described in Robert Schwarzl's master thesis.\cite{Schwarzl2021} For the measurements detector A was used at all times in combination with a picoscope 5442D. An equal sided, UV translucent, prism is inserted to remove any remainders of the fundamental probe wavelength at the detector. To improve this separation an extra iris may be used immediately in front of the detector.\\
The prism should be placed such that the angle between pump and probe is further increased, as this can help reach full pump rejection without any other filters or beamblocks involved. For each change of the probe the mirror coupling into the prism should be adjusted for maximum intensity of the probe on the detector, which can be monitored using the fourierDetector() matlab program.\\
The detector has a maximum peak to peak voltage (Vpp) of approximately 3 V, which means that the Vpp should be kept below this value to avoid response problems and thus systematic errors in the measurement.
\subsection{Adjusting overlap without achromatic optics}

\subsubsection{General overlap adjustment}
Overlap adjustments are done using a camera onto which the sample plane is imaged. This is combined with a fitting program, which fits a Gaussian pointspread function to the beam image. From this a center position as well as the FWHM of the pointspread function can be determined and used to move the pointspread functions on top of each other. The detailed software explanations and their use is explained in \ref{chp:Software}\\

\paragraph{The problem of achromatic optics}
One of the main issues that had to be addressed was the change from achromatic objectives to uncoated plano-convex lenses within the cage.\newline
This is emphasized especially by plotting the wavelength dependence of the focal length as defined by the lensmaker equation for the lenses used:
\begin{equation}
\frac{1}{f} = (n-1) \left[\frac{1}{R_1} - \frac{1}{R_2} + \frac{(n-1)d}{n R_1 R_2}\right]
\end{equation}
\begin{figure}[h]
\centering

\begin{subfigure}[b]{0.45\textwidth}
\centering
\includegraphics[width =\textwidth]{images/DispersionUVFS.png} 
\caption{Refractive index of UV fused silica glass\cite{Malitson:65}}
\end{subfigure}
\hfill
\begin{subfigure}[b]{0.45\textwidth}
\centering
\includegraphics[width =\textwidth]{images/ChromaticAberration.png} 
\caption{Chromatic focal shift}
\end{subfigure}

\caption{Refractive index change and focal shift for UV fused silica plano-convex lenses used in cage setup}
\end{figure}

Furthermore the depth of focus may be visualized by plotting the beam waist diameter over distance from the focal point for several relevant focal lengths in fig. ....

The change of the depth of focus (DOF) and thus the change in beam waist diameter for a specific distance from the focal point of the corresponding wavelength decreases for higher photon energies.

\begin{figure}[h]
\centering
\begin{subfigure}[t]{0.5\textwidth}
\centering
\includegraphics[width =\textwidth]{images/BeamWaist_Wavs_2.5mm.png} 
\subcaption{Beam waist for wavelengths at \mbox{2.5 mm} input beam width}
\end{subfigure}
\hfill
\begin{subfigure}[t]{0.5\textwidth}
\centering
\includegraphics[width =\textwidth]{images/BeamWaist_inputWidth_653nm.png} 
\subcaption{Beam waist over input beam width at 653 nm}
\end{subfigure}
\\
\begin{subfigure}[t]{0.5\textwidth}
\includegraphics[width =\textwidth]{images/DOFintensity_inputWidth_653nm.png} 
\subcaption{Maximum radiance intensity relative to maximum intensity in focus depending on input beam width at 653 nm[check if this assumption is correct]}
\end{subfigure}
\caption{Changes of Gaussian beamprofile width and intensity for cage lenses}
\end{figure}

This issue is of fundamental nature and a few attempts were made until the following solution was found:

\subsubsection{Sample mirror path}\label{SampleMirrorCamera}
The option that finally won out is decoupling the beams after the frontal cage lens and imaging onto a camera that is in the mirror plane of the sample surface. This method requires a method for consistent placement of the mirror within the cage and a way to move the camera into the mirror plane of the sample.\\

\begin{figure}[hbtp]
\centering
\includegraphics[width = \linewidth]{images/SHG-focusing-large.png}
\caption{Detailed focusing setup using a mirror after the first cage lens to image the beam pointspread distributions as it is in the sample plane.
Pump path is abridged.}
\end{figure}

\paragraph{Calibration method}
The rear lens is set to image the sample plane onto the camera as described in \ref{regRearFocus} with a pump adjacent wavelength used to illuminate the sample. This is done to be able to use the pump beam as a reference for the cage system, as the front focus for the sample and the rear focus for the camera are both calibrated using a wavelength with very little chromatic focal shift from it.\\
A two step process is then used to get the position of the camera in the mirrored sample path correct:
\begin{enumerate}
\item Adjust the frontal camera distance so, that the pump beam profile is right before inversion, due to passing through the focal point. Inversion being the outer features of the beam profile passing through the center. The intensity still rises a bit beyond that point. Attention has to be paid to not go into inversion, which is hard to tell by eye. After a first good calibration this could be done by comparing the fitted intensity value/FWHM of the beam profile, as long as the pump beam path did not change. Placement of OD filter in front of camera or in front of cage does matter, swapping the position changes the beam profile.
\item Set the probe to the same or an adjacent wavelength to the pump and setup overlap using the rear camera. Due to beampaths and thus spherical aberration this may be a tedious process and not completely accurate. Check the overlap on the frontal camera by moving the camera back and forth and observing if the beams cross through their centers. If that is the case the pump probe overlap should be given optimally and the frontal camera can be set to the optimum position of this overlap. Take reference TA measurements to if possible to check if there is an improvement from the purely DMK set position.
\end{enumerate}
\paragraph{Setup}
Former is solved by a 45 degree mirror insert for the cage, which was designed to rest on top of the cage system rails. This drop in mirror mount was 3d printed for adjustability and has proven to be consistent enough to allow for this method to work. \\
An advantage of PLA as opposed to aluminium with the negative of the rails cut into it is that it allows proper sliding into place, whereas aluminium "gripped" onto the rails making it hard to get consistent placement. This may be improved by cutting the rail negative even slightly bigger. However this still presents one with the problem of how to mount the mirror to the mount. Super glueing  the mirror to a aluminium mount was attempted for a quick trial, but this proved to not be a long lived connection.\\
The 3d printed mount can be seen in fig. ....
Considerations regarding use of rubber bands or 3d printed fittings were made, however it turns out just by moving the mirror drop-in mount against a solid surface, such as one of the cage plates holding the rails, is sufficiently reproducible for the sensor resolution of the camera used. (alternatively also reference the change in beam diameter according to rayleigh length etc)\\

The lighting for imaging the rear sample onto the camera via the rear lens is done using a ring light with 4 LEDs, which have a spectral intensity distribution close to the targeted pump beam. The spectrum can be seen in fig. ...\\
It has proven beneficial to illuminate so that a only scattered light is detected, as this should improve contrast. Thus the LED ring is placed behind the sample, on the side of the rear camera. As this means reduced total intensity any light not scattered by the sample or reflected from nearby surfaces needs to be blocked. For this carton is placed around the rear cage rails, cutting away any light reflected from the sample mount.
%The LEDs are mounted onto a square aluminium frame and are angled towards the sample to illuminate it evenly. To properly setup the focus light that not passing through the lens has to be minimized or contrast will be lost. To focus properly a small scratch is introduced to the edge of the sample, which allows better contrast for focusing as well and allows to focus closer to the center to the layer than to the top or bottom of the layer. (eh questionable, think better)

\paragraph{Use}
During use care has to be taken that there is no clipping at the drop in mirror, as this would obviously ruin the beamshape. As mentioned before if there is an OD filter directly in front of the camera for one beam fitting, there should be an OD filter there as well for the other beam, as this may cause a change in the observed beam shape.\\
For high energy SHG light absorptive OD filters have far stronger absorption than for their calibrated range, thus they may need to be swapped for a lower value. With this effect also an "amplification" of observed fundamental light from the SHG stage is introduced, which is further increased by the CMOS sensor having less quantum efficiency at these wavelengths. Thus it is important to check if the fundamental wavelength has a strong influence on the observed pointspread function.\\
This can be done by introducing more glass filters, in case their absorption of the fundamental is lacking for the wavelength. The glass filters may be removed afterwards if the detector is using the prism setup, which removes the fundamental wavelength from the measurement.\\
Another option to check is to remove the fundamental filter completely and check the position of the fundamental focus spot in relation to the SHG focus spot, which will be different due to chromatic focal shift.

\subsubsection{Regular Focusing after Cage}\label{regRearFocus}
This is the option used for the regular TAM setup as described in \ref{RegTAM}. The last mirror in front of the detector is simply removed to reveal a camera behind it. The rear cage objective is focused onto this camera using white light from an LED torch or similar lightsources in transmission. Afterwards the front objective is moved such that a satisfactory pointspread function of the beam is seen from the camera sensor.\\ 
This is sufficient as the achromatic objectives allow a very similar focus for all wavelengths between 400 nm and 940 nm. The rear objective simply projects the pointspread function of the beams in the plane of the sample to which it was focused to, while moving the front objective adjusts the part of the focusing beam cone, and thus the size of the slice of the beam, which interacts with the sample. This is working for both pump and probe.\\
Since the focal length of the lenses varies wildly in the UV this is not an option for the UV extension.
\subsubsection{Dummy Conversion Sample}
An idea, later on abandoned for impracticality, was to use a "dummy" sample acting as a screen to then be imaged onto the camera in the rear using the lens. This method has several requirements:
\begin{itemize}
\item The screen needs to allow for diffuse imaging of the sample without disturbing the beamshape too much.
\item Any UV or near UV light needs to be converted to the visible region, where the focal length difference becomes negligible.
\end{itemize}

The requirement for diffuse imaging is simple. Any collimation or focusing action of the beam needs to be lost to actually image the sample plane, where the "dummy" is placed at. The requirement is less stringent for wavelengths close to a chosen wavelength to which the setup would be calibrated to, as the lenses would image the beam fine for that wavelength.\\

For the issue of UV conversion a few attempts with different dyes and paper were made, which showed variable success as to their luminescence.\\
Generally paper combined with orange gel marker (Stabilo No. 70/40) seemed to work best for conversion of UV to visible light.
Paper soaked with wax to increase transmittance and smooth out scattering alone did not work particularly well for conversion, unless combined with text marker. Marker has to be applied ahead of the wax and on the other side of the paper, from where the wax will be applied. (I am considering just throwing this all out, though having an off hand comment shouldn't be too bad) 

Using a microscope slide with gelled, specifically at room temperature evaporated, Stabilo marker (No. 70/40) turned out to have decent conversion efficiency, but lacks any diffusivity.  This could work, based on adjusting the cage setup to the pump wavelength, so it is correctly imaged. However at that time the rear focus was still set with white light instead of 653 nm pump adjacent light, which would not have allowed for this method. This also leads to problems as soon as the probe light has long enough wavelengths to simply transmit through the glass slide. It would need to be filtered and one would have to rely on conversion of those wavelengths via the marker to produce sensible output, which is a big gamble. An attempt at texturing the slide surface was not made, due to unavailability of suitable processing methods (I think I tried scratching etc, got to check notes). Another unanswered question is the emission spectrum of the marker gel. (lab notes  starting in june)\\

Another idea was to use thin coloured PMMA on top of a glass slide or simply. Fluorescence of an orange PMMA was given, however not better than the marker. On top of that it proved insoluble in acetone making coating impossible.\\

Surprisingly the frontal focus point found with this projection method coincides well with the finally used frontal focus point. The mounts used should be within 0.2 mm of the sample surface position. The projection screens may add some extra extra offset, especially the gel on glass one would need adjustment.
Overall the attempted projection screen method did not seem viable and thus was not pursued further. A main disadvantage, apart from problems with wavelength conversion, is that in the best case the scattering applies a strong averaging to the beam pointspread function, which does not allow for detection of deviations of the beam shape from a Gaussian distribution. Unless a very consistent and fine scattering projection screen with good conversion to a specific wavelength band close to the pump is found it just is infeasible.





\chapter{Software}\label{chp:Software}
\section{Overlap Compensation}
Opposed to the old setup, where the achromatic objectives guaranteed relatively consistent overlap of pump and probe, the UV setup has the need to correct the variation between the single measurements, since the diffraction of the dispersive elements in the probe path varies strongly in the UV range and any compensation via the telescope will be imperfect.\newline
Relevant for this are the beam size of the probe as well as the overlap of the pump and the probe beam in the sample. Variations in those parameters are induced by change of the beamshape due to SHG generation, imperfect alignment of the SHG telescope and correction of the chromatic aberration for different wavelength settings of the probe.\newline

\subsection{Beam Characterisation}
The python class ArtFit has some options to check for the validity of the data used. Since the data is saved in a raw format, however it is cut and thus an offset for the ROI has to be accounted for.

ArtFit may parse 3 different input types: (think of something different, not meaningful like this)
\begin{enumerate}
\item Quick plotting of raw data:\\
With a path to a raw data file and an optional bool value, which is used to tell the program to use the standard size of 1280x720 instead of a square pixel array size deduced from total number of entries. Plots the beam intensity profile without any processing.
\item Single beam profile with background subtraction: \\
Loads a JSON characterising the background file, including a set offset of ROI, the path for the beam profile to be loaded and a width for fitting.
\item Two beam profiles with background subtraction: \\
ROI offset has to be identical and is again defined by a JSON file with background location.
\end{enumerate}

To get meaningful data for correction of data the pump power has to be set using setPumpPower() and the scale can optionally be overwritten from the background file with setScale(). Fitting is done by calling plainFit(id), where id = 1 for probe (first path handed over) and id = 2 for pump (second path).

Some options to show 
\begin{itemize}
\item plotComp()\\
Shows an intensity contour plot of both beams on top of each other. If only one beam file is loaded only one is shown. Also shows the fitted intensity slices on top of each other for both pixel array axis. Returns an overlap value corresponding to what is given by the liveFitting program described in section \ref{Sec:LiveFitting}.
\item plotGauss()\\
Plots the intensity profile of the beams, if both are given, separately with an overlayed contour plot of the fits, to allow to ascertain the validity of the fit. Needs to have already fitted data with plainFit() to show the Gaussian distribution. Fitted data may be printed to console by setting printData = True for the options. The intensity profile is shown by default without background subtraction and can be shown with subtracted background by handing over a boolean. The fits are always done with subtracted background, the profile just is not shown background subtracted by default.
\end{itemize}
\subsection{Correction Factor}\label{sec:CorrFactor}
The correction factor aims to equilibrate the dOD of the given pump-probe overlap to one where the pump is constant in radiance over the entire probe area or in a physical description is infinitely larger than the probe beam.
Thus for very high $\mathrm{\frac{\sigma_{Pump}}{\sigma_{Probe}} \rightarrow \infty}$ the correction factor tends to 1, which is the smallest value.\\
%The factor is calculated from the Gaussian intensity distributions as seen in eq. \ref{CorrFactorGaussians}, of which the derivation is shown in section \ref{GaussiansDerivation} or in Bromiley\cite{Bromiley2014}, which was used to check correctness. The enumerator is the integral over essentially the probe intensity with the constant factor of the maximum pump intensity 
The idea of the factor is a normalisation of the overlap of the beams to an ideal state. This ideal state corresponds to an equal pump intensity over the entire probe beam, that would allow the entire probe to experience the same change in absorption. Thus the correction factor C is chosen as the integral over the product of the ideal pump, an infinite plateau, with the Gaussian probe. The denominator on the other hand is the integral over actual product of the Gaussian fits of pump and probe beam.
\begin{equation}\label{eq:CorrFactorGaussians}
C = \dfrac{\int I_{pump}^*\cdot I_{probe}(x) \;dx}{\int I_{pump}(x)\cdot I_{probe}(x) \; dx} = \dfrac{c^*\cdot \int I_{probe} dx}{S_{12}} = \dfrac{c*}{S_{12}}
\end{equation}
The ideal plateau pump is chosen to be the maximum of the actual pump normal distribution, to decouple correction factor from the pump width??? Rethink and justify the reasoning physically. Mathematically it is needed so that the correction factor does not tend to infinite when S12 goes to zero. Maybe simulate it if you cannot show it physically
\begin{equation*}
I_{pump}^* = c^* = max(I_{pump}(x)) = \frac{1}{\sqrt{2\cdot\pi}\cdot\sigma_{pump}}
\end{equation*}

$\mathrm{S_{12}}$ is defined as can be seen in eq. \ref{eq:S12CorrectionFactor} and serves as the extra normalisation factor for rewriting the product of the two Gaussians into a single Gaussian. The derivation of the single Gaussian can be seen in \ref{GaussiansDerivation} and has been cross-checked with Bromiley.\cite{Bromiley2014}

\begin{equation}\label{eq:S12CorrectionFactor}
S_{12} = \dfrac{1}{\sqrt{2\pi\left(\sigma_1^2+\sigma_2^2\right)}}\cdot exp\left(-\dfrac{\left(\mu_1 - \mu_2\right)^2}{2\cdot \left(\sigma_1^2+\sigma_2^2\right)}\right)
\end{equation}

This leaves the full correction factor C to be:
\begin{equation}\label{eq:fullCorrectionFactor}
C = \sqrt{\frac{\sigma_1^2+\sigma_2^2}{\sigma_1^2}}\cdot exp \left(\frac{\left(\mu_1-\mu_2\right)^2}{2\cdot \left(\sigma_1^2+\sigma_2^2\right)}\right)
\end{equation}

A few illustrations of the behaviour of the correction factor are shown in fig.

Furthermore to have all relative $\mathrm{\Delta OD}$ values be directly comparable, the correction factor is divided by the peak radiance value.

\begin{table}[h]
\begin{tabular}{lll}
$\Delta \mu$ / $\sigma$               & $\dfrac{\sigma_{pump}}{\sigma_{probe}}$ / 1 & Correction Factor                                                                                                \\ \hline
0                                     & 1                                           & $\sqrt{2}$                                                                                                        \\
$\Delta\mu$                           & 1                                           & $\sqrt{2} exp \left( \dfrac{\Delta \mu ^2}{4}\right)$                                                             \\
$\approx \sigma$                      & 1                                           & $\sqrt{2}exp\left(\dfrac{1}{4}\right)$                                                                            \\
$\infty$ & 1                                           & $\sim$ exp$\left(\Delta mu ^2 \right)$ \\
$2\cdot\sqrt{2 ln(2)}\sigma$       & 1                                           & $\sqrt{2}exp(2ln2)\approx 5.6$                                                                                    \\
0                                     & 3                                           & $\sqrt(\dfrac{9+1}{9}) \approx 1.054$                                                                             \\
0                                     & 1/3                                         & $\sqrt(\dfrac{9+1}{1}) \approx 3.2$                                                                               \\
0                                     & 1/2                                         & $\sqrt(\dfrac{4+1}{1}) \approx 2.2$                                                                               \\
0                                     & 2                                           & $\sqrt(\dfrac{4+1}{4}) \approx 1.12$                                                                             
\end{tabular}
\end{table}

To ascertain how well this works a numeric variant of the correction factor is considered based on the same principle as eq. \ref{eq:CorrFactorGaussians}:
\begin{equation*}
C_{numeric} = \sum_{i=0}^{N_x}\sum_{k=0}^{N_y}\frac{max\left(I_{pump}\right)\cdot I_{probe}(x_i,y_k)}{I_{pump}(x_i,y_k)\cdot I_{probe}(x_i,y_k)}
\end{equation*}
where $\mathrm{x_i/y_k}$ are discrete points, which may be associated with single pixels of the camera, of which there are $mathrm{N_x}$ for $\mathrm{x_i}$ and $\mathrm{N_y}$ for $\mathrm{y_k}$. $\mathrm{max\left(I_{pump})\right)}$ once again is the maximum value of $\mathrm{I_{pump}}$ over all $\mathrm{x_i, y_k}$. For this definition $\mathrm{I_{pump}/I_{probe}}$ may be of arbitrary noisy form, which is what will be tested in the following.

Comparing the numeric approach with the analytic fitting approach is done by generating a hypothetical pump and probe Gaussian pair, for which the correction factors are calculated. The analytic value is generated directly from the generating parameters for the numeric discrete map. For $\mathrm{I_{pump} = const}$ the correction factor trivially goes to one as per definition. Since the discrete values strongly depend on the number of bins an approach is chosen, where a density of discrete points per $\mathrm{\sigma}$ of the generating Gaussian distribution is shown. To visualize this the correction factor of a "pump" and "probe" combination, where $\mathrm{\sigma}"$ and $\mathrm{\mu}$ are identical for both distributions, is show over a number of bin sizes is shown in fig. \ref{fig:NumericalCorrectionSNR}. The bin size is chosen so that always a multiple of two discrete values per axis is binned together and the bins are kept square in size. The influence of a noise component, randomly distributed for a specific signal to noise ratio, is also shown.

\begin{figure}[h]\label{fig:NumericalCorrectionSNR}
\centering
\includegraphics[width=0.9\linewidth]{images/NumericalCorrectionSNR.png}
\caption{Comparison of numerical and analytic correction factors for Gaussian distributions of identical parameters.\\For the case of the SNR graphs a random noise was added individually to both distributions.}
\end{figure}

To check for possible effects regarding offsetting of the distributions from the pixel grid and breaking the symmetry from above the Gaussian distributions are now shifted by 1 $\mathrm{\sigma}$ in both x and y direction from each other in fig. \ref{fig:NumericalCorrectionShift}. Furthermore both distributions together are shifted by an offset from the pixel grid in x direction. Doing this incremental shift in both x and y direction only leads to a small change for large binning sizes. 

\begin{figure}[h]\label{fig:NumericalCorrectionShift}
\centering
\includegraphics[width=0.9\linewidth]{images/NumericalCorrectionShiftedBeams.png}
\caption{same sig, shifted by sig in both x and y respective of each other, incremental offset influence shown}
\end{figure}
\textbf{NOTE SOMEWHERE: the actual size of the pointspread function on the sensor is at about 2-4 points per sig -> not sensible without fitting}

\subsection{Artray-LiveFitting}\label{Sec:LiveFitting}
As the Artray $\mathrm{ARTCAM-092UV-WOM}$ could not be interfaced with matlab using the webcam library a C\# program was created based on the manufacturers example program.
Issues with our system are that for our specific camera or system setup a periodic variation of low intensity signal is reported by the C\# based program, while this periodic variation is missing in the official software. Attempts were made to troubleshoot this in correspondence with the manufacturer, who were very forthcoming in the matter, but it could not be solved so far. To overcome this problem a simple background subtraction has been devised as sufficient, as the variation seems to be constant over time. The background has been recorded with the lens cap on at an exposure of 15 ms, which was chosen after comparing the subtracted quality output of 0.3 ms, 15 ms and 100 ms. 
\newline
For all measurements included here version 1.2 was used. The  ALGLIB software package is used and (version number)\footnote{ALGLIB for C\# licensed as per GPL 2} for fitting a Gaussian to the beamshape. Scottplot 4 is used to display the fitted data.\\
\subsubsection{Fitting principle}
In version 1.2 the relevant fitting parameters are returned as a numeric overlap integral based on the Gaussian beamshapes. In this version it is still calculated numerically from the fits, however it can be rebased into an analytical form as per eq. \ref{GaussianProduct} which describes the product of two Gaussians.
\begin{equation}
overlap = \int \sqrt{f_1(x)*f_2(x)}dx =  \sqrt{\frac{2 \sigma_1^2\sigma_2^2}{\sigma_1^2+\sigma_2^2}}\cdot exp\left(-\frac{\left(\mu_1-\mu_2\right)^2}{4\cdot \left(\sigma_1^2 + \sigma_2^2\right)}\right)
\end{equation}
This is calculated separately for both axis of the pixel array and then multiplied for a final value. 
This is not directly related to correction factor calculated within the python program to make everything comparable, but is more of a measure of how similar the beams are, which is why only the normal distributions are used without an intensity modifier, thus both beams are weighted identically. \\
This is reasonable as the best results for the correction factor are achieved when pump and probe beams are similar in size. This overlap integral returns a maximum value of 1 when the beams are identical and falls off quickly if the intensity maxima are shifted and slowly if the FWHM of the beams is different.\\
\subsubsection{Operation}
Before startup all needed DLL files need to be in the same folder as the executable.\footnote{alglib.net.dll, ArtCamSdk\_092UV\_WOM.dll, ScottPlot.dll, "ScottPlotWinForms.dll", Python.Runtime.dll,...} need to be in the same folder as the executable. Additionally .NET Framework 3.5 is required. Upon startup the program should automatically connect to the camera. \\
The main forms shown upon startup are the camera control form in fig. \ref{fig:ArtrayMain} and the fitting form in fig. \ref{fig:ArtrayFitting}.

\begin{figure}[hbtp]\label{fig:ArtrayMain}
\centering
\includegraphics[width = 0.6\linewidth]{images/ArtrayExamplePics/ArtrayControlledMain.PNG}
\caption{Artray Controlled window}
\end{figure}

\begin{figure}[hbtp]\label{fig:ArtrayFitting}
\centering
\includegraphics[width = 0.6\linewidth]{images/ArtrayExamplePics/FittingForm.PNG}
\caption{Fitting form artray\\Scottplot 4 is used to generate the output for this figure.}
\end{figure}


To get an image there are several options in the "Display" drop down menu.
\begin{itemize}
\item Preview: starts a livestream within the "Artray Controlled" window.
\item Snapshot: takes an image and statically shows it. If possible a fit will be shown in the "LiveFit" window.
\item Callback: starts a livestream with periodic fitting. Preview should be preferred if no fitting is needed or possible for performance reasons.
\end{itemize}

To adjust the image parameters or camera settings use the "Settings" drop down menu.
\begin{itemize}
\item Camera settings: opens a menu to set the image format including size and ROI as well as Color format, which is to be set to "Color 48*bit" for reasons that are explained in raw data output. The effective ROI should be set to 300 pixels vertically and horizontally. The ROI should stay square and not rectangular, as there is a bug preventing correct data manipulation at this moment. An example of the settings can be seen in fig. 
\item Filter settings: include software settings for brightness, contrast, saturation etc. Influence of Bayer Mode is unknown. Keep the saturation at -255.
\item Analog settings: consist of gain and exposure. Also has the option to mirror image vertically and horizontally, which should not done after calibration. There is no way of telling from raw output data at which setting a snapshot was taken.
\item Misc: is where custom settings for output parameters as well as exposure can be set. Assigning a "µm per px" value and adjusting the power correctly allows a readout directly corrected peak radiance and other fit parameters such as the FWHM.\\The three exposure values can be quickly jumped to from a drop down menu in the main window and are supposed to help streamline the measurement process. The menu can be seen in fig. 
\end{itemize}

\begin{figure}[hbtp]
\centering
\includegraphics[width = 0.6\linewidth]{images/ArtrayExamplePics/StreamProperties.PNG}
\caption{Menu for camera settings given by Artray\\ Example settings to get good data output within a square ROI.}
\end{figure}

\begin{figure}[hbtp]
\centering
\includegraphics[scale=1]{images/ArtrayExamplePics/DefaultMiscSettings.PNG}
\caption{Miscellaneous menu for setting quick change exposure values and additional constants to correct fitting output.\\
Default value of µm per px means that the fitting form only shows the FWHM and related values in units of pixels.\\
The exposure values are in 0.1 µs steps, as this is what the camera allows. Only integer input is supported.}
\end{figure}



As mentioned quick swap exposure settings can be set. They are accessed from the drop down menu "SwitchExp". Upon switching exposure a snapshot is taken, this interrupts all other image acquisition types, and a maximum value is reported in a pop up window, to show if the dynamic range of the camera is being used well. If that is not the case the fitting window either turns blue if the exposure is too low \textbf{(percent of max?)} or turns red if it is too high \textbf{(percent of max?)}. Setting exposure can in cases be slower than readout of the snapshot, thus reporting a value ahead of setting the new exposure value. If that is the case just set exposure again if one wishes to get the maximum pixel intensity value.\\

The file drop down consists of features for saving, opening and comparing data:
\begin{itemize}
\item Save: saves a raw txt file of the last captured image. In case of a livestream this is the last shown image. For snapshot it saves the currently shown snapshot.
\item End: Ends the program, leads mainly to pain due to accidental clicking
\item Reference: sends a reference image, behaviour is like with save regarding livestreams, to the "LiveFit" window. There a fit of the reference is shown as a red graph, which when not set is flat.
\item Open: works like reference, however it opens the reference snapshot from a raw txt file of choice via file dialogue.
\item Background: sets a background to subtract from the images for live fitting. Setting background does not alter the behaviour of Save. Saved files are still plain raw unaltered data from the sensor. The background file location is automatically loaded when starting a session and is saved in the windows registry. under $\mathrm{"Computer \backslash HKEY_CURRENT_USER \backslash SOFTWARE \backslash LiveFit"}$as BACKGROUND\_FILE. The LiveFit subkey needs to be created manually, possible with regedit, ahead of use. The BACKGROUND\_FILE subkey is automatically added or handled.
\end{itemize}
\subsubsection{Inner workings of the software}
The software package is based on the SDK provided freely by Artray in C\#, specifically on the CS.NET\_Graphic example software. 

\paragraph{raw data output}
Data is handled as one dimensional byte arrays by the SDK and has to be processed into a workable format. The camera specifications allow for a maximum bit depth of 12 bit. To be able to access this bit depth the video format of "Color 48bit*" has to be set, as the monochrome formats do not allow higher bit depth. Adjusted software by the manufacturer was attempted, but abandoned on our side due to troubleshooting issues. The single pixel data for the "Color 48 bit*" setting is encoded as 2 byte per colour channel per pixel. Since, even though this is a monochrome camera, the colour output was not the same colour values for all returned subpixel types, meaning RGB, the saturation of the camera was set to be minimal in software (-255). This leads to identical red, green and blue subpixel values. From these 3 colour values red is arbitrarily chosen for further processing.
The data formatting is explained with the help of fig. \ref{fig:ByteArtrayOut}. Both bytes are formatted as big endian or most significant bit first. The second byte holds the most significant bit, with the first hex value and thus 4 bits being empty. The first bit holds the remaining 8 bit of the 12 bit value.

\begin{figure}[hbtp]\label{fig:ByteArtrayOut}
\centering
\includegraphics[scale=1]{images/ArtrayByteImage.png}
\caption{Data scheme of periodic byte structure of artray output with hexadecimal placeholders\\
$\mathrm{H_{22}}$ holds the 4 most significant bit and byte 1 is simply appended\\
$\mathrm{0_{21}}$ of byte 2 is always empty.}
\end{figure}

The via bitwise operations processed value is then assigned to a short integer array. Notably for processing the region of interest (ROI) needs to be known. It is not included in any of the raw data itself.

\chapter{SQIB in PMMA}


\section{Wavelength dependence of 1\% SQIB in PMMA}
The sample is 1wt\% SQIB in a PMMA solid solution. The sample is not annealed and shows fluorescence if illuminated by white light, implying the influence of neighbouring molecules is not strong enough to quench the fluorescence at this concentration. \\
An average nearest neighbour distance for this concentration may be taken as 2.36 nm, however the actual spread of distances is a large distribution. Thus there is an expectation of some quenching of effects such as fluorescence as well as decay times of excited states. However all effects are still observed due to the distribution of nearest neighbour distances as well as random rotation of nearest neighbours to each other, leading to inefficient charge transport or quenching.\textbf{look at model and see if it even is applicable}\cite{Zheng2020} \\
Collective effects like davydov splitting, which are dependent on a macroscopic crystalline orientation of molecules, are negligible for samples that are not annealed at this kind of concentration.

\begin{figure}[hbtp]
\centering
\includegraphics[width=\linewidth]{images/TimeResolvedWavelengthScanSQIB1perc_PMMA.png}
\caption{Time resolved (fitted) transient absorbancy of 1\% SQIB PMMA}
\end{figure}

\chapter{Examination of reliability}
Some tests have been done to ascertain the validity and stability of the corrections devised for the UV extended TAM.
\section{Power settings}
For measurements to be valid there should be a linear correspondence of pump power and the measured absorbancy. Main concern here is that pump power is under the threshold radiance for any two photon processes within the sample to have a meaningful influence, which would affect the linearity of pump power dependence. Meanwhile for the probe pulse it is important, that its intensity does not saturate the sample by itself leading to a GSB.\\
To test this multiple pump and probe power combinations were tested, at the same sample position with the same pump probe overlap. The linearity of the sample is shown for powers up to \textbf{use radiance instead} 10 µW pump and.... probe combinations. \textbf{Show the relatively linear plot}

\section{Correction value accuracy}
As laid out in section \ref{sec:CorrFactor} a correction factor is calculated for every measurement point to compensate error in lateral position as well as in relative size of pump and probe beam.\\
To check this measurements with varying overlap were taken, the pump was left at the same position. 

\section{Sample degradation}




\chapter*{Used materials}
\begin{longtable}{p{0.48\textwidth}p{0.48\textwidth}}
    \caption{List of devices used}
    \label{tab:devices} \\
    \toprule 
    Title & Remarks \\
    \midrule
    \endfirsthead
    \toprule 
    Title & Remarks \\
    \midrule
    \endhead
    \midrule
    Continued on next page
    \endfoot
    \bottomrule
    \endlastfoot
    Light Conversion PHAROS & Yb:KGW femtosecond laser, PH1-20-0400-02-30, L191103; \SI{40}{\kilo\hertz} repetition rate at \SI{400}{\micro\joule} pulse energy \\
    Light Conversion ORPHEUS N-3H & NOPA, $ \lambda = \SIrange{500}{950}{\nano\meter} $ \\
    Light Conversion ORPHEUS N-2H & NOPA, $ \lambda = \SIrange{640}{950}{\nano\meter} $ \\
    Scitec 310 CD with 300CD200HS & Optical chopper, frequency $\approx \SIrange{1000}{55000}{\hertz}$, focusing on chopper wheel using two $f=\SI{125}{\milli\meter}$ plano-convex N-BK7 lenses \\
    Scitec S310Sync synchroniser & Phase and frequency locking of the chopper to external sources (function generator, laser sync output, frequency divider) \\
    Thorlabs AHWP05M-600 & \SIrange{400}{800}{\nano\meter} achromatic $\frac{\lambda}{2}$ plate \\
    Thorlabs AHWP10M-980 & \SIrange{690}{1200}{\nano\meter} achromatic $\frac{\lambda}{2}$ plate \\
    Thorlabs NExxA series, Thorlabs NDxxA series, Eksma Optics 240-25xx series & Reflective and absorptive neutral density filters, used for coarse power setting \\
    Reflective variable neutral density filters & Used to set input power exactly \\
    BG39, UG5 glass filters \\
    Thorlabs FESH0700, Newport FS-SWF set & Sputtered short-pass filters \\
    Thorlabs FELH0700 & Sputtered long-pass filter \\
    Thorlabs WP25M-UB & Ultra-broad wire grid polariser \\
    Film polarisers (not really) & For visible imaging microscopy \\
    Olympus UPlan FL N 10x & Focussing objective, 10x magnification, NA=0.3 \\
    Nikon Plan 10/0.3 160/0.17 & Imaging objective, 10x magnification, NA=0.3 \\
    EKSMA 110-1216E & plano-convex UVFS lenses\\
    mounted prism & UV translucent, unknown model\\
    Linos HighLED White & For visible imaging microscopy \\
    Sample illumination LED ring & 658 nm (measured), LT3080 current regulation for 12 V input \\
    The Imaging Source DMK 42AUC03 & Monochrome camera, particularly for spatial overlap alignment, beam shape characterization and orientation on the sample \\
    Artray ARTCAM-092UV-WOM & UV sensitive CMOS camera, used for spatial overlap\\
    Detector A & High-speed optical detectors based on Hamamatsu S1336-8BQ photodiode, JFET operational amplifiers, an analogue  long-pass filter for signal elongation and impedance converters for calibration \\
    Picoscope 5442D & Oscilloscope used for data collection from optical detectors \\
    Coherent LabMax Pro & Pulse measuring head, used for optimizing OPA output \\
    Coherent FieldMate with OP2-VIS measuring head & Laser power meter, used for setting input power, partially damaged leading to higher low intensity readings (SN: 1019L08R) \\
    Newport LTA-HS & Delay stage actuator \\
    Thorlabs Z825B, KDC101 & Microscopy sample stage actuators (horizontal and vertical) \\
    Various aluminium mirrors & Planar and concave (for focussing onto detectors) \\
    74HC73 & Dual JK flip-flop for frequency division
\end{longtable}
\begin{longtable}{p{0.48\textwidth}p{0.48\textwidth}}
    \caption{List of software used}
    \label{tab:devices} \\
    \toprule 
    Title & Remarks \\
    \midrule
    \endfirsthead
    \toprule 
    Title & Remarks \\
    \midrule
    \endhead
    \midrule
    Continued on next page
    \endfoot
    \bottomrule
    \endlastfoot
    Spectrometer software spectraLight & Light Conversion; malfunctioned with update and superseded by Waves \\
    Spectrometer software Waves & BROADCOM; Version 2.2.2.0\\
\end{longtable}

\chapter{Derivations of formula}
\section{Produkt of two Gaussians}\label{GaussiansDerivation}
This calculation has been cross checked with Bromiley.\\
Begin with two Gaussian distributions $\mathrm{G_1(x) and G_2(x)}$ and combine the exponential terms.
\begin{equation*}
\begin{split}
G_{12}(x) & =  G_1(x) \cdot G_2(x) \\ 
& = \frac{1}{2\pi \sigma_1 \sigma_2}
exp\left(-\frac{1}{2}\left[\frac{\left(x-\mu_1\right)^2}{\sigma_1^2} + \frac{\left(x-\mu_2\right)^2}{\sigma_2^2} \right]\right)
\\
& = \frac{1}{2\pi \sigma_1 \sigma_2} exp \left(-\frac{1}{2\sigma_1^2 \sigma_2^2} \left[
\sigma_2^2 \left(x^2 - 2 \mu_1 x + \mu_1^2 \right) + 
\sigma_1^2 \left(x^2 - 2 \mu_2 x + \mu_2^2 \right)
\right] \right)
\\
& = \frac{1}{2\pi \sigma_1 \sigma_2} exp \left(-\frac{1}{2\sigma_1^2 \sigma_2^2} \left[
x^2(\sigma_1^2+\sigma_2^2) - 2x(\mu_1\sigma_2^2 + \mu_2\sigma_1^2) + (\sigma_1^2 \mu_2^2 + \sigma_2^2 \mu_1^2)
\right] \right)
\end{split}
\end{equation*}
Simplify by dividing by the following substitution and add a zero $0 = \epsilon - \epsilon$ into the exponential function.
\begin{equation*}
\sigma_{12} := \sqrt{\sigma_1^2+\sigma_2^2}
\end{equation*}
\begin{equation*}
G_{12}(x) = \frac{1}{2\pi \sigma_1 \sigma_2} exp \left(-\frac{\sigma_{12}^2}{2\sigma_1^2\sigma_2^2}\left[
x^2 - 2x\frac{\mu_1\sigma_2^2+ \mu_2\sigma_1^2}{\sigma_{12}^2} + \frac{\sigma_1^2\mu_2^2 + \sigma_2^2\mu_1^2}{\sigma_{12}^2}
+ \epsilon - \epsilon
\right]\right)
\end{equation*}
Now find $\epsilon$ to fulfil the binomial theorem $x^2- 2xb + \tilde{b}^2 + \epsilon - \epsilon= (x-b)^2 - \epsilon$ within the exponent, where $\epsilon$ is used to compensate such that $\mathrm{b^2 = \tilde{b}^2 + \epsilon}$.
\begin{gather*}
\left(\frac{\mu_1 \sigma_2^2 + \mu_2\sigma_1^2}{\sigma_{12}^2}\right)^2 \stackrel{!}{=} \frac{\sigma_1^2\sigma_2^2 + \sigma_2^2\mu_1^2}{\sigma_{12}^2} + \epsilon
\\
\begin{split}
\epsilon \cdot \sigma_{12}^4  & = \mu_2^2\sigma_1^4 + \mu_1^2\sigma_2^4 + 2\mu_1\mu_2\sigma_1^2\sigma_2^2 - \sigma_1^2\mu_2^2(\sigma_1^2+ \sigma_2^2) - \sigma_2^2\mu_1^2(\sigma_1^2+ \sigma_2^2)\\
& = - (\mu_1^2\sigma_1^2\sigma_2^2 + \mu_2^2\sigma_1^2\sigma_2^2 - 2 \mu_1\mu_2\sigma_1^2\sigma_2^2)\\
& = - \sigma_1^2\sigma_2^2(\mu_1-\mu_2)^2
\end{split}
\end{gather*}
Now one can return to $\mathrm{G_{12}(x)}$ and insert the found value for epsilon. With this the exponential function can be split into a part dependent on x and one independent of it.
\begin{equation*}
G_{12}(x) = \frac{1}{2\pi\sigma_1\sigma_2}\cdot exp\left(- \frac{\sigma_{12}^2}{2\sigma_1^2\sigma_2^2\sigma_{12}^4}\sigma_1^2\sigma_2^2\left(\mu_1-\mu_2\right)^2
\right) \cdot
exp\left(-\frac{\sigma_1^2+\sigma_2^2}{2\sigma_1^2\sigma_2^2} \left[x - \frac{\mu_1\sigma_2^2+\mu_2\sigma_1^2}{\sigma_{12}^2}\right]^2 \right)
\end{equation*}
Simplifying the equation using the substitutions that specify the $\sigma$ and $\mu$ of the combined Gaussian distribution:
\begin{gather*}
\sigma_{new} := \frac{\sigma_1\sigma_2}{\sigma_{12}}\\
\mu_{new} := \frac{\mu_1\sigma_2^2+ \mu_2\sigma_1^2}{\sigma_{12}^2}
\end{gather*}
With these the combined Gaussian can be split into a "classical" Gaussian part and a scaling parameter $S_{12}$.
\begin{gather*}
\begin{split}
G_{12}(x) & = \frac{1}{\sqrt{2\pi}\sigma_{new}}\frac{\sigma_{new}}{\sqrt{2\pi}\sigma_1\sigma_2}\cdot exp\left(- \frac{\left(\mu_1-\mu_2\right)^2}{2\sigma_{12}^2}\right) \cdot
exp\left(-\frac{\left(x-\mu_{new}\right)^2}{\sigma_{12}^2}\right)\\
& = S_n \cdot \frac{1}{\sqrt{2\pi}\sigma_{new}} \cdot exp\left(-\frac{\left(x-\mu_{new}\right)^2}{2\sigma_{new}^2}\right)
\end{split}
\end{gather*}
\begin{equation*}
S_{n} := \dfrac{1}{\sqrt{2\pi\left(\sigma_1^2+\sigma_2^2\right)}}\cdot exp\left(-\dfrac{\left(\mu_1 - \mu_2\right)^2}{2\cdot \left(\sigma_1^2+\sigma_2^2\right)}\right)
\end{equation*}

\bibliographystyle{ieeetr}
\bibliography{MasterThesisPrep}

\end{document}
